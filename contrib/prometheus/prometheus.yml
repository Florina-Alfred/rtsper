# Prometheus configuration for scraping rtsper instances
# Place this file under contrib/prometheus/ and start Prometheus with
# `prometheus --config.file=/path/to/contrib/prometheus/prometheus.yml`.

global:
  scrape_interval: 15s
  evaluation_interval: 15s

# Rule files (alerting/recording). See rules.yml in the same directory.
rule_files:
  - "rules.yml"

scrape_configs:
  - job_name: 'rtsper'
    # Scrape all rtsper instances by service name (works when Prometheus runs
    # inside the same Docker Compose network). If you run Prometheus on the
    # host, replace these with host-mapped ports (e.g. localhost:8080).
    static_configs:
      - targets: ['rtsper1:8080', 'rtsper2:8080', 'rtsper3:8080']
    metrics_path: /metrics
    scheme: http

  - job_name: 'rtsper-cluster'
    # Multiple rtsper instances in a cluster (service names for Docker Compose)
    static_configs:
      - targets: ['rtsper1:8080', 'rtsper2:8080', 'rtsper3:8080']
    metrics_path: /metrics

  # node exporter job removed by default because host.docker.internal is not
  # always available inside Linux Docker engines. If you run a node exporter
  # in your Compose network, add its service name (e.g. 'node-exporter:9100')
  # as a target here or re-enable the job locally.

# Example of relabeling to add an environment label or normalize instance
# Uncomment and adapt if you need to rewrite labels per job
#scrape_configs:
#  - job_name: 'rtsper-with-relabel'
#    static_configs:
#      - targets: ['rtsper-prod-1:8080']
#    relabel_configs:
#      - source_labels: [__address__]
#        target_label: instance
#      - replacement: 'prod-cluster-a'
#        target_label: cluster
